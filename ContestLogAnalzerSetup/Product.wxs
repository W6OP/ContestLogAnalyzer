<?xml version="1.0" encoding="UTF-8"?>
<?define ProductVersion = "1.0.48"?>
<?define ProductUpgradeCode = "e7d24a3a-1258-402f-8cbc-8a4a603f6542"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
	<Product Id="*" Name="Contest Log Analzer" Language="1033" Version="$(var.ProductVersion)" Manufacturer="W6OP" UpgradeCode="$(var.ProductUpgradeCode)">
		<Package InstallerVersion="200" Compressed="yes" InstallScope="perMachine" />

    <!-- http://zumalifeguard.wikia.com/wiki/WiX_Examples -->
		<MajorUpgrade DowngradeErrorMessage="A newer version of [ProductName] is already installed." />
    <Condition Message="You need to be an administrator to install this product.">
      Privileged
    </Condition>
    <Condition Message="A newer version of this software is already installed.">NOT NEWERVERSIONDETECTED</Condition>
    <MediaTemplate EmbedCab="yes" />

    <!--<Icon Id="ProductIcon" SourceFile="C:\Users\pbourget\Documents\Visual Studio Projects\Ham Radio\DXAConsole\DXAConsole\Images\DXAConsole.ico"/>-->
    <!--<Property Id="ARPPRODUCTICON" Value="ProductIcon"/>-->
    <Property Id="ARPHELPLINK" Value="http://w6op.com"/>
    <UIRef Id="WixUI_Mondo" />
    <UIRef Id="WixUI_ErrorProgressText" />
     <WixVariable Id="WixUILicenseRtf" Value="$(var.ContestLogAnalyzer.ProjectDir)License.rtf" />
    <Upgrade Id="$(var.ProductUpgradeCode)">
      <UpgradeVersion Minimum="$(var.ProductVersion)" OnlyDetect="yes" Property="NEWERVERSIONDETECTED"/>
      <UpgradeVersion Minimum="0.0.0" Maximum="$(var.ProductVersion)" IncludeMinimum="yes" IncludeMaximum="no"
                      Property="OLDERVERSIONBEINGUPGRADED"/>
    </Upgrade>

    <PropertyRef Id="NETFRAMEWORK45"/>
    <Condition Message="This application requires .NET Framework 4.6.1. Please install the .NET Framework then run this installer again.">
      <![CDATA[Installed OR NETFRAMEWORK45]]>
    </Condition>
    
    
		<Feature Id="ProductFeature" Title="ContestLogAnalzer" Level="1" Description='Setup program for the W6OP Contest Log Analyzer.' ConfigurableDirectory='INSTALLFOLDER'>
			<ComponentGroupRef Id="ProductComponents" />
     <ComponentRef Id="ApplicationShortcut" />
		</Feature>
	</Product>

	<Fragment>
		<Directory Id="TARGETDIR" Name="SourceDir">
			<Directory Id="ProgramFilesFolder">
        <Directory Id="W6OP" Name="W6OP">
				  <Directory Id="INSTALLFOLDER" Name="Contest Log Analzer" />
        </Directory>
			</Directory>
      <Directory Id="ProgramMenuFolder">
        <Directory Id="ApplicationProgramsFolder" Name="W6OP"/>
      </Directory>
		</Directory>
	</Fragment>

	<Fragment>
		<ComponentGroup Id="ProductComponents" Directory="INSTALLFOLDER">
			<!-- TODO: Remove the comments around this Component element and the ComponentRef below in order to add resources to this installer. -->
		 <Component Id="ProductComponent" Guid="9e3766f5-495f-4390-b295-16f88beda9e1">         
       <File Id='ContestLogAnalyzer' Name='ContestLogAnalyzer.exe' DiskId='1' Source='C:\Users\pbourget\Documents\Visual Studio Projects\Ham Radio\ContestLogAnalyzer\Deploy\ContestLogAnalyzer.exe' KeyPath='yes'></File>
       <File Id='ContestLogAnalyzer.config' Name='ContestLogAnalyzer.exe.config' DiskId='1' Source='C:\Users\pbourget\Documents\Visual Studio Projects\Ham Radio\ContestLogAnalyzer\Deploy\ContestLogAnalyzer.exe.config' KeyPath='no'></File>
       <File Id='LogAnalyzerCommon' Name='LogAnalyzerCommon.dll' DiskId='1' Source='C:\Users\pbourget\Documents\Visual Studio Projects\Ham Radio\ContestLogAnalyzer\Deploy\LogAnalyzerCommon.dll' KeyPath='no'></File>
       <File Id='AnalysisEngine' Name='AnalysisEngine.dll' DiskId='1' Source='C:\Users\pbourget\Documents\Visual Studio Projects\Ham Radio\ContestLogAnalyzer\Deploy\AnalysisEngine.dll' KeyPath='no'></File>
       <File Id='Cabrillo' Name='Cabrillo.dll' DiskId='1' Source='C:\Users\pbourget\Documents\Visual Studio Projects\Ham Radio\ContestLogAnalyzer\Deploy\Cabrillo.dll' KeyPath='no'></File>
       <File Id='ScoreEngine' Name='ScoreEngine.dll' DiskId='1' Source='C:\Users\pbourget\Documents\Visual Studio Projects\Ham Radio\ContestLogAnalyzer\Deploy\ScoreEngine.dll' KeyPath='no'></File>
       <File Id='PrintEngine' Name='PrintEngine.dll' DiskId='1' Source='C:\Users\pbourget\Documents\Visual Studio Projects\Ham Radio\ContestLogAnalyzer\Deploy\PrintEngine.dll' KeyPath='no'></File>
       <File Id='itextsharp' Name='itextsharp.dll' DiskId='1' Source='C:\Users\pbourget\Documents\Visual Studio Projects\Ham Radio\ContestLogAnalyzer\Deploy\itextsharp.dll' KeyPath='no'></File>
       <File Id='csvhelper' Name='csvhelper.dll' DiskId='1' Source='C:\Users\pbourget\Documents\Visual Studio Projects\Ham Radio\ContestLogAnalyzer\Deploy\csvhelper.dll' KeyPath='no'></File>
       <File Id='DocumentFormat.OpenXml' Name='DocumentFormat.OpenXml.dll' DiskId='1' Source='C:\Users\pbourget\Documents\Visual Studio Projects\Ham Radio\ContestLogAnalyzer\Deploy\DocumentFormat.OpenXml.dll' KeyPath='no'></File>
       <File Id='Licensertf' Name='License.rtf' DiskId='1' Source='$(var.ContestLogAnalyzer.ProjectDir)License.rtf'/>
     </Component> 
		</ComponentGroup>
	</Fragment>

<!-- Ignore warning about mismatched component reference -->
  <Fragment Id="ShortcutLocation">
    <DirectoryRef Id="ApplicationProgramsFolder">
      <Component Id="ApplicationShortcut" Guid="C9568446-1E62-462B-99CC-BE016D3C29D1">
        <Shortcut Id="ApplicationStartMenuShortcut"
                  Name="Contest Log Analyzer"
                  Description="Contest Log Analyzer"
                  Target="[#ContestLogAnalyzer]"
                  WorkingDirectory="APPLICATIONROOTDIRECTORY"/>
        <RemoveFolder Id="ApplicationProgramsFolder" On="uninstall"/>
        <RegistryValue Root="HKCU" Key="Software\[Manufacturer]\[ProductName]" Name="installed" Type="integer" Value="1" KeyPath="yes"/>
      </Component>
    </DirectoryRef>
  </Fragment>
</Wix>